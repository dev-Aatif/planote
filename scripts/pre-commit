#!/bin/bash
# Pre-commit hook for Planote
# Ensures code compiles before committing
#
# Installation:
#   cp scripts/pre-commit .git/hooks/pre-commit
#   chmod +x .git/hooks/pre-commit

echo "Running pre-commit checks..."

# Check if build directory exists
if [ ! -d "build" ]; then
    echo "Build directory not found. Run 'meson setup build' first."
    exit 1
fi

# Quick compile check (just core library)
echo "Checking compilation..."
if ! ninja -C build core/libplanote.so 2>/dev/null; then
    echo "❌ Compilation failed. Please fix errors before committing."
    exit 1
fi

echo "✅ Pre-commit checks passed!"
exit 0
